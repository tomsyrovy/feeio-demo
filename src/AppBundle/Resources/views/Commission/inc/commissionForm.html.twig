{% form_theme form 'bootstrap_3_layout.html.twig' %}

{#{% macro widget_prototype(widget) %}#}

    {#{% if widget.vars.prototype is defined %}#}
        {#{% set form = widget.vars.prototype %}#}
        {#{% set userCompany = widget.vars.prototype.userCompany %}#}
        {#{% set type = widget.vars.prototype.commissionUserCompanyRelationType %}#}
        {#{% set name = widget.vars.prototype.vars.name %}#}
    {#{% else %}#}
        {#{% set form = widget %}#}
        {#{% set userCompany = widget.userCompany %}#}
        {#{% set type = widget.commissionUserCompanyRelationType %}#}
        {#{% set name = widget.vars.full_name %}#}
    {#{% endif %}#}

    {#<div class="form-group" data-content="{{ name }}">#}
        {#<div class="row">#}
            {#<div class="col-lg-5">#}
                {#{{ form_widget(userCompany) }}#}
            {#</div>#}
            {#<div class="col-lg-5">#}
                {#{{ form_widget(type) }}#}
            {#</div>#}
            {#<div class="col-lg-2 text-right">#}
                {#<a href="#" class="btn btn-danger btn-block btn-remove" data-related="{{ name }}">#}
					{#<i class="fa fa-trash"></i>#}
				{#</a>#}
            {#</div>#}
        {#</div>#}
    {#</div>#}

{#{% endmacro %}#}


<div class="col-lg-6 col-lg-offset-3">

    {#<div class="row">#}
        {#<div class="col-lg-12">#}
            {#<ul class="nav nav-tabs nav-tabs-light nav-justified">#}
                {#<li role="presentation" class="active">#}
                    {#<a href="#basic-info" aria-controls="basic-info" role="tab" data-toggle="tab">#}
                        {#Základní údaje#}
                    {#</a>#}
                {#</li>#}
                {#<li role="presentation">#}
                    {#<a href="#other-info" aria-controls="other-info" role="tab" data-toggle="tab">#}
                        {#Oprávnění zakázky <i class="fa fa-spinner fa-spin animation"></i>#}
                    {#</a>#}
                {#</li>#}
            {#</ul>#}
        {#</div>#}
        {#<!-- .col-lg-12 -->#}
    {#</div>#}
    {#<!-- .row -->#}


    <div class="panel panel-default">
        <div class="panel-body">

            {{ form_start(form, {'attr' : {'id' : 'commissionForm'}}) }}

            <div class="tab-content">

                {#<!-- 1. záložka -->#}
                <div role="tabpanel" class="tab-pane active" id="basic-info">

                    <div class="row">
                        <div class="col-lg-12">
                            {{ form_row(form.nameOwn) }}
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-12">
                            {{ form_row(form.description) }}
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-lg-12">
                            {{ form_row(form.repeatable) }}
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-lg-6">
                            {{ form_row(form.startDate) }}
                            {{ form_row(form.endDate) }}
                        </div>
                        <div class="col-lg-6">
                            {{ form_row(form.status) }}
                            {{ form_row(form.billable) }}
                        </div>
                    </div>

                </div>
                <!-- .tab-pane -->


                {#<!-- 2. záložka -->#}
                {#<div role="tabpanel" class="tab-pane" id="other-info">#}

                    {#{{ form_label(form.commissionUserCompanyRelations) }}#}

                    {#<div id="relations"#}
                         {#data-prototype="{{ _self.widget_prototype(form.commissionUserCompanyRelations)|escape }}">#}
                        {#{% for relation in form.commissionUserCompanyRelations %}#}

                            {#{{ _self.widget_prototype(relation) }}#}

                        {#{% endfor %}#}
                    {#</div>#}

                    {#<br>#}
                    {#<a href="#" class="btn btn-default btn-sm btn-block btn-add" data-target="relations"><i class="fa fa-plus"></i></a>#}


                    {#<div class="alert alert-helper alert-info alert-dismissible" role="alert">#}
                        {#<button type="button" class="close" data-dismiss="alert" aria-label="Close">#}
                            {#<span aria-hidden="true">&times;</span>#}
                        {#</button>#}

                        {#<p>#}
                            {#Oprávnění zakázky slouží k definování práv uživatelů a jejich přístupu k zakázce. Nejde však o nastavení týmu.#}
                        {#</p>#}
                    {#</div> <!-- .alert -->#}


                {#</div>#}
                <!-- .tab-panel -->
            </div>
            <!-- .tab-content -->


            <div class="text-center">
                <input class="btn btn-primary" type="submit" value="{{ submitLabel }}">
            </div>

            {#Do not remove this condition block, it is used for set default values of client and companyGroup during updating commission#}
            {#{% if commission is defined %}#}

                {#<input type="hidden" id="appbundle_commission_company_id" value="{{ commission.company.id }}">#}

                {#{% if commission.client %}#}

                    {#<input type="hidden" id="appbundle_commission_client_id" value="{{ commission.client.id }}">#}

                {#{% endif %}#}

                {#{% if commission.companyGroup %}#}

                    {#<input type="hidden" id="appbundle_commission_companyGroup_id" value="{{ commission.companyGroup.id }}">#}

                {#{% endif %}#}

            {#{% endif %}#}

            {{ form_widget(form._token) }}

            {{ form_end(form, {'render_rest': false}) }}


        </div>
        <!-- .panel-body -->
    </div>
    <!-- .panel -->

</div> <!-- .col-lg-6 -->