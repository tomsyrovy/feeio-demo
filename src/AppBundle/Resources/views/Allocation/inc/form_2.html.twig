{% form_theme form 'bootstrap_3_layout.html.twig' %}

{% set colspan = 19 %}

{% macro widget_prototype2(widget, colspan) %}

    {% if widget.vars.prototype is defined %}
        {% set form = widget.vars.prototype %}
        {% set externalSource = widget.vars.prototype.externalSource %}
        {% set generalSource = widget.vars.prototype.generalSource %}
        {% set concreteSource = widget.vars.prototype.concreteSource %}
        {% set generalSourceExt = widget.vars.prototype.generalSourceExt %}
        {% set concreteSourceExt = widget.vars.prototype.concreteSourceExt %}
        {% set unit = widget.vars.prototype.unit %}
        {% set quantityPlan = widget.vars.prototype.quantityPlan %}
        {% set buyingPricePlan = widget.vars.prototype.buyingPricePlan %}
        {% set sellingPricePlan = widget.vars.prototype.sellingPricePlan %}
        {% set quantityReal = widget.vars.prototype.quantityReal %}
        {% set buyingPriceReal = widget.vars.prototype.buyingPriceReal %}
        {% set sellingPriceReal = widget.vars.prototype.sellingPriceReal %}
        {% set name = widget.vars.prototype.vars.full_name %}
    {% else %}
        {% set form = widget %}
        {% set externalSource = widget.externalSource %}
        {% set generalSource = widget.generalSource %}
        {% set concreteSource = widget.concreteSource %}
        {% set generalSourceExt = widget.generalSourceExt %}
        {% set concreteSourceExt = widget.concreteSourceExt %}
        {% set unit = widget.unit %}
        {% set quantityPlan = widget.quantityPlan %}
        {% set buyingPricePlan = widget.buyingPricePlan %}
        {% set sellingPricePlan = widget.sellingPricePlan %}
        {% set quantityReal = widget.quantityReal %}
        {% set buyingPriceReal = widget.buyingPriceReal %}
        {% set sellingPriceReal = widget.sellingPriceReal %}
        {% set name = widget.vars.full_name %}
    {% endif %}

    <tr data-content="{{ name }}" class="row-item">
        <td class="cell-externalSource cell-simple cell-extended">
            {{ form_widget(externalSource) }}
        </td>
        <td class="cell-generalSource cell-simple cell-extended">
            {{ form_widget(generalSource) }}
        </td>
        <td class="cell-concreteSource cell-simple cell-extended">
            {{ form_widget(concreteSource) }}
        </td>
        <td class="cell-generalSourceExt cell-simple cell-extended">
            {{ form_widget(generalSourceExt) }}
        </td>
        <td class="cell-concreteSourceExt cell-simple cell-extended">
            {{ form_widget(concreteSourceExt) }}
        </td>
        <td class="cell-unit cell-simple cell-extended">
            {{ form_widget(unit) }}
        </td>
        <td class="cell-quantityPlan cell-simple cell-extended">
            {{ form_widget(quantityPlan) }}
        </td>
        <td class="cell-buyingPricePlan cell-simple cell-extended">
            {{ form_widget(buyingPricePlan) }}
        </td>
        <td class="cell-marginPlan cell-simple cell-extended">
            <input type="text" class="form-control">
        </td>
        <td class="cell-sellingPricePlan cell-simple cell-extendedn">
            {{ form_widget(sellingPricePlan) }}
        </td>
        <td class="cell-sumBuyingPricePlan cell-simple cell-extended">
            <input type="text" class="form-control" readonly="readonly">
        </td>
        <td class="cell-sumSellingPricePlan cell-simple cell-extended">
            <input type="text" class="form-control" readonly="readonly">
        </td>
        <td class="cell-sumProfitPlan cell-simple cell-extended">
            <input type="text" class="form-control" readonly="readonly">
        </td>
        <td class="cell-quantityReal cell-extended">
            {{ form_widget(quantityReal) }}
        </td>
        <td class="cell-buyingPriceReal cell-extended">
            {{ form_widget(buyingPriceReal) }}
        </td>
        <td class="cell-marginReal cell-extended">
            <input type="text" class="form-control">
        </td>
        <td class="cell-sellingPriceReal cell-extended">
            {{ form_widget(sellingPriceReal) }}
        </td>
        <td class="cell-sumBuyingPriceReal cell-extended">
            <input type="text" class="form-control" readonly="readonly">
        </td>
        <td class="cell-sumSellingPriceReal cell-extended">
            <input type="text" class="form-control" readonly="readonly">
        </td>
        <td class="cell-sumProfitReal cell-extended">
            <input type="text" class="form-control" readonly="readonly">
        </td>

        <td class="text-right">
            <a href="#" style='margin-left: 5px' class="btn btn-xs btn-danger btn-remove" data-related="{{ name }}">
                <i class="fa fa-trash"></i>
            </a>
        </td>
    </tr>

{% endmacro %}

{% macro widget_prototype(widget, colspan) %}

    {% if widget.vars.prototype is defined %}
        {% set form = widget.vars.prototype %}
        {% set n = widget.vars.prototype.name %}
        {% set name = widget.vars.prototype.vars.name %}
    {% else %}
        {% set form = widget %}
        {% set n = widget.name %}
        {% set name = widget.vars.name %}
    {% endif %}

    <tbody class="top-content" data-content="{{ name }}">
        <tr>
            <td colspan="{{ (colspan-2) }}">
                {{ form_row(n) }}
            </td>
            <td colspan="3" class="text-right">
                <a href="#" class="btn btn-danger btn-remove" data-related="{{ name }}" style="margin-left: 30px;">
                    <i class="fa fa-trash"></i>
                </a>
            </td>
        </tr>
    </tbody>
    <tbody class="middle-label" data-content="{{ name }}">
        <tr class="row-simple row-extended">
            <td class="cell-simple cell-extended"></td>
            <td class="cell-simple cell-extended"></td>
            <td class="cell-simple cell-extended"></td>
            <td class="cell-simple cell-extended"></td>
            <td class="cell-simple cell-extended"></td>
            <td class="cell-simple cell-extended"></td>
            <td class="cell-simple cell-extended"></td>
            <td class="cell-simple cell-extended"></td>
            <td class="cell-simple cell-extended">&sum;</td>
            <td class="cell-simple cell-extended">&sum;</td>
            <td class="cell-simple cell-extended">&sum;</td>
            <td class="cell-extended"></td>
            <td class="cell-extended"></td>
            <td class="cell-extended"></td>
            <td class="cell-extended"></td>
            <td class="cell-extended">&sum;</td>
            <td class="cell-extended">&sum;</td>
            <td class="cell-extended">&sum;</td>
            <td></td>
        </tr>
        <tr class="row-simple row-extended">
            <td class="cell-simple cell-extended"></td>
            <td class="cell-simple cell-extended">Položka</td>
            <td class="cell-simple cell-extended">Dodavatel</td>
            <td class="cell-simple cell-extended">Jednotka</td>
            <td class="cell-simple cell-extended">Množství</td>
            <td class="cell-simple cell-extended cell-update" data-label-simple="Náklad / mj." data-label-extended="Nákupní cena">Nákupní cena</td>
            <td class="cell-simple cell-extended">Marže (%)</td>
            <td class="cell-simple cell-extended cell-update" data-label-simple="Výnos / mj." data-label-extended="Prodejní cena">Prodejní cena</td>
            <td class="cell-simple cell-extended cell-update" data-label-simple="Náklad" data-label-extended="Nákupní cena">Nákupní cena</td>
            <td class="cell-simple cell-extended cell-update" data-label-simple="Výnos" data-label-extended="Prodejní cena">Prodejní cena</td>
            <td class="cell-simple cell-extended">Rozdíl</td>
            <td class="cell-extended">Množství</td>
            <td class="cell-extended">Nákupní cena</td>
            <td class="cell-extended">Marže (%)</td>
            <td class="cell-extended">Prodejní cena</td>
            <td class="cell-extended">Nákupní cena</td>
            <td class="cell-extended">Prodejní cena</td>
            <td class="cell-extended">Rozdíl</td>
            <td></td>
        </tr>
        <tr class="type row-extended">
            <td class="cell-simple cell-extended"></td>
            <td class="cell-simple cell-extended"></td>
            <td class="cell-simple cell-extended"></td>
            <td class="cell-simple cell-extended"></td>
            <td class="cell-simple cell-extended">plán</td>
            <td class="cell-simple cell-extended">plán</td>
            <td class="cell-simple cell-extended">plán</td>
            <td class="cell-simple cell-extended">plán</td>
            <td class="cell-simple cell-extended">plán</td>
            <td class="cell-simple cell-extended">plán</td>
            <td class="cell-simple cell-extended">plán</td>
            <td class="cell-extended">reál</td>
            <td class="cell-extended">reál</td>
            <td class="cell-extended">reál</td>
            <td class="cell-extended">reál</td>
            <td class="cell-extended">reál</td>
            <td class="cell-extended">reál</td>
            <td class="cell-extended">reál</td>
            <td></td>
        </tr>
    </tbody>

    <tbody class='middle-content' id="allocationContainerListItems_{{ name }}" data-prototype="{{ _self.widget_prototype2(form.allocationContainerListItems, colspan)|escape }}" data-content="{{ name }}">
        {% for allocationContainerListItem in form.allocationContainerListItems %}
            {{ _self.widget_prototype2(allocationContainerListItem, colspan) }}
        {% endfor %}
    </tbody>

    <tbody class="sep" data-content="{{ name }}">
        <tr>
            <td colspan="{{ colspan }}">
                <a href="#" class="btn btn-xs btn-default btn-add" data-target="allocationContainerListItems_{{ name }}" data-regex="__name2__"><i class="fa fa-plus"></i> nová položka</a>
            </td>
        </tr>
    </tbody>

    <tbody class='low-content' data-content="{{ name }}" data-total="allocationContainerListItems_{{ name }}">
        <tr class="total">
            <td colspan="3" class="cell-simple cell-extended">mezisoučet</td>
            <td class="cell-simple cell-extended"></td>
            <td class="cell-simple cell-extended"></td>
            <td class="cell-simple cell-extended"></td>
            <td class="cell-simple cell-extended"></td>
            <td class="cell-simple cell-extended"></td>
            <td class="cell-sumBuyingPricePlan cell-simple cell-extended">
                <input type="text" class="form-control" readonly="readonly">
            </td>
            <td class="cell-sumSellingPricePlan cell-simple cell-extended">
                <input type="text" class="form-control" readonly="readonly">
            </td>
            <td class="cell-sumProfitPlan cell-simple cell-extended">
                <input type="text" class="form-control" readonly="readonly">
            </td>
            <td class="cell-extended"></td>
            <td class="cell-extended"></td>
            <td class="cell-extended"></td>
            <td class="cell-extended"></td>
            <td class="cell-sumBuyingPriceReal cell-extended">
                <input type="text" class="form-control" readonly="readonly">
            </td>
            <td class="cell-sumSellingPriceReal cell-extended">
                <input type="text" class="form-control" readonly="readonly">
            </td>
            <td class="cell-sumProfitReal cell-extended">
                <input type="text" class="form-control" readonly="readonly">
            </td>
            <td></td>
        </tr>
    </tbody>

{% endmacro %}

{#<div class="col-lg-12">#}

    {{ form_errors(form) }}

    {{ form_start(form, {'attr' : {'id' : 'form'}}) }} <!-- začne formulář -->

    <div class="panel panel-default">
        <div class="panel-body">

            <div class="row">
                <div class="col-lg-12">
                    <div class="btn-group">
                        <button type="button" class="btn-change-form btn btn-sm btn-default" data-rel="extended">Rozšířený formulář</button>
                        <button type="button" class="btn-change-form btn btn-sm btn-default" data-rel="simple">Zjednodušený formulář</button>
                    </div>
                    <br><br>
                </div>
            </div>


            <div class="row">
                <div class="col-lg-12">
                    <table class="table-form" id="allocationContainerLists" data-prototype="{{ _self.widget_prototype(form.allocationContainerLists, colspan)|escape }}">
                        {% for allocationContainerList in form.allocationContainerLists %}

                            {{ _self.widget_prototype(allocationContainerList, colspan) }}

                        {% endfor %}
                        <tfoot>
                            <tr class="sep">
                                <td colspan="{{ colspan }}">
                                    <a href="#" class="btn btn-default btn-add" data-target="allocationContainerLists" data-regex="__name__"><i class="fa fa-plus"></i> nový seznam položek</a>
                                </td>
                            </tr>
                            <tr class="grand-total">
                                <td colspan="3" class="cell-simple cell-extended">SOUČET</td>
                                <td class="cell-simple cell-extended"></td>
                                <td class="cell-simple cell-extended"></td>
                                <td class="cell-simple cell-extended"></td>
                                <td class="cell-simple cell-extended"></td>
                                <td class="cell-simple cell-extended"></td>
                                <td class="cell-sumBuyingPricePlan cell-simple cell-extended">
                                    <input type="text" class="form-control" readonly="readonly">
                                </td>
                                <td class="cell-sumSellingPricePlan cell-simple cell-extended">
                                    <input type="text" class="form-control" readonly="readonly">
                                </td>
                                <td class="cell-sumProfitPlan cell-simple cell-extended">
                                    <input type="text" class="form-control" readonly="readonly">
                                </td>
                                <td class="cell-extended"></td>
                                <td class="cell-extended"></td>
                                <td class="cell-extended"></td>
                                <td class="cell-extended"></td>
                                <td class="cell-sumBuyingPriceReal cell-extended">
                                    <input type="text" class="form-control" readonly="readonly">
                                </td>
                                <td class="cell-sumSellingPriceReal cell-extended">
                                    <input type="text" class="form-control" readonly="readonly">
                                </td>
                                <td class="cell-sumProfitReal cell-extended">
                                    <input type="text" class="form-control" readonly="readonly">
                                </td>
                                <td></td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>

            <div class="row">
                <div class="col-lg-12 text-left">
                    <input class="btn btn-primary" type="submit" value="{{ submitLabel }}">
                    <a data-href-extended="{{ path('app_commission_detail_allocation_export', {'allocation_id': ac.id, 'commission_id': ac.commission.id, 'type': 'extended'}) }}" data-href-simple="{{ path('app_commission_detail_allocation_export', {'allocation_id': ac.id, 'commission_id': ac.commission.id, 'type': 'simple'}) }}" class="btn-xls btn btn-default">Exportovat do XLS</a>
                    <!-- mezi začátek a konec je možné vkládat vlastní formulářové prvky, ale pokud nejsou vloženy i na backendu, tak nebudou zpracovány -->
                </div>
            </div>

        </div> <!-- .panel-body -->
    </div> <!-- .panel -->


    {{ form_widget(form._token) }}

    {{ form_end(form, {'render_rest': false}) }} <!-- skončí formulář (dovykreslí nevykreslené prvky formuláře a poté ukončovací značku) -->

<!-- a takto to je všechno - určitě budeš potřebovat vědět, jaké jsou názvy (name) prvků ve formuláři - tyto names zjistíš tak, že si dáš vykreslit celý formulář a v kodu v prohližeči to najdeš, nebo si otevřeš soubor, který definuje formulář (resp. formulářový typ: src/AppBundle/Form/Type/ContactFormType.php) -->

{#</div> <!-- .col-lg-6 -->#}